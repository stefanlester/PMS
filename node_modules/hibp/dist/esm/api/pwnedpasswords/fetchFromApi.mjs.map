{"version":3,"file":"fetchFromApi.mjs","sources":["../../../../src/api/pwnedpasswords/fetchFromApi.ts"],"sourcesContent":["import fetch from 'isomorphic-unfetch';\nimport { BAD_REQUEST } from './responses';\n\n/**\n * Fetches data from the supplied API endpoint.\n *\n * HTTP status code 200 returns plain text (data found).\n * HTTP status code 400 throws an Error (bad request).\n *\n * @internal\n * @private\n * @param {string} endpoint the API endpoint to query\n * @param {object} [options] a configuration object\n * @param {string} [options.baseUrl] a custom base URL for the\n * pwnedpasswords.com API endpoints (default: `https://api.pwnedpasswords.com`)\n * @param {string} [options.userAgent] a custom string to send as the User-Agent\n * field in the request headers (default: `hibp <version>`)\n * @returns {Promise<string>} a Promise which resolves to the data resulting\n * from the query, or rejects with an Error\n */\nexport function fetchFromApi(\n  endpoint: string,\n  /* istanbul ignore next: no need to test default empty object */\n  {\n    baseUrl = 'https://api.pwnedpasswords.com',\n    userAgent,\n  }: { baseUrl?: string; userAgent?: string } = {},\n): Promise<string> {\n  const config = Object.assign(\n    {},\n    userAgent\n      ? {\n          headers: {\n            'User-Agent': userAgent,\n          },\n        }\n      : {},\n  );\n\n  const url = `${baseUrl.replace(/\\/$/g, '')}${endpoint}`;\n\n  return fetch(url, config).then((res) => {\n    if (res.ok) return res.text();\n\n    if (res.status === BAD_REQUEST.status) {\n      return res.text().then((text) => {\n        throw new Error(text);\n      });\n    }\n\n    throw new Error(res.statusText);\n  });\n}\n"],"names":["fetchFromApi","endpoint","baseUrl","userAgent","config","Object","assign","headers","url","replace","fetch","then","res","ok","text","status","BAD_REQUEST","Error","statusText"],"mappings":";;;AAGA;;;;;;;;;;;;;;;;;;SAiBgBA,aACdC;iFAK8C;0BAF5CC;MAAAA,oCAAU;MACVC,iBAAAA;;AAGF,MAAMC,MAAM,GAAGC,MAAM,CAACC,MAAP,CACb,EADa,EAEbH,SAAS,GACL;AACEI,IAAAA,OAAO,EAAE;AACP,oBAAcJ;AADP;AADX,GADK,GAML,EARS,CAAf;AAWA,MAAMK,GAAG,aAAMN,OAAO,CAACO,OAAR,CAAgB,MAAhB,EAAwB,EAAxB,CAAN,SAAoCR,QAApC,CAAT;AAEA,SAAOS,KAAK,CAACF,GAAD,EAAMJ,MAAN,CAAL,CAAmBO,IAAnB,CAAwB,UAACC,GAAD;AAC7B,QAAIA,GAAG,CAACC,EAAR,EAAY,OAAOD,GAAG,CAACE,IAAJ,EAAP;;AAEZ,QAAIF,GAAG,CAACG,MAAJ,KAAeC,WAAW,CAACD,MAA/B,EAAuC;AACrC,aAAOH,GAAG,CAACE,IAAJ,GAAWH,IAAX,CAAgB,UAACG,IAAD;AACrB,cAAM,IAAIG,KAAJ,CAAUH,IAAV,CAAN;AACD,OAFM,CAAP;AAGD;;AAED,UAAM,IAAIG,KAAJ,CAAUL,GAAG,CAACM,UAAd,CAAN;AACD,GAVM,CAAP;AAWD;;;;"}